<html>
<head>
</head>
<body>
    <script type="text/javascript" src="https://formit3d.github.io/FormItExamplePlugins/SharedPluginFiles/FormItInterface.js"></script>
    <script src="formit_with_lumion.js"></script>
    <script>
        FormItInterface.Initialize(() => {
            window.LumionLiveSync = {};

            //remember state;
            let isFollowing = false;
            
            LumionLiveSync.Start = async () => {

                const settings = JSON.parse(localStorage.getItem('LumionSettings'));

                //TODO pass these to API.
                const cameraSync = settings.cameraSync || false;
                const colorAsMat = settings.colorAsMat || false;
                const useCurrentUCS = settings.useCurrentUCS || false;

                await FormIt.LumionLiveSync.Start();
            };

            LumionLiveSync.End = async () => { 
                await FormIt.LumionLiveSync.End();
            };

            LumionLiveSync.SyncLumionCamera = async () => { 
                await FormIt.LumionLiveSync.SyncLumionCamera();
            };

            LumionLiveSync.FollowLumionCameraOn = async () => {
                await FormIt.LumionLiveSync.FollowLumionCamera(true);
            };

            LumionLiveSync.FollowLumionCameraOff = async () => {
                await FormIt.LumionLiveSync.FollowLumionCamera(false);
            };

            LumionLiveSync.Settings = async () => {
                const dialogParams = {
                    "PluginName": "Lumion Settings",
                    "DialogBox": `${window.location.origin}/settings.html`,
                    "DialogBoxWidth": 300,
                    "DialogBoxHeight": 200,
                    "DialogBoxType": "Modeless"
                };

                FormItInterface.CallMethod("FormIt.CreateDialogBox", JSON.stringify(dialogParams));
            };

            LumionLiveSync.TODO = async () => {
                //TODO needs implemented
            };

            LumionLiveSync.NOOP = () => {};

        });
            
    </script>
</body>

</html>
